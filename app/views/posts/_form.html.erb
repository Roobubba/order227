<%= render 'shared/errors', obj: @post %> 

<%= form_for @post do |f| %>
  <div class="row main-text">
    <div class="col-sm-5">
      <%= f.label :title %>
    </div>
    <div class="col-sm-7 form-group">
      <%= f.text_field :title, class: "form-control" %>
    </div>
    <div class="col-sm-5">
      <%= f.label :post_text %>
    </div>
    <div class="col-sm-7 form-group">
      <%= f.text_area :post_text, class: "form-control" %>
    </div>
    <div class="col-sm-5 form-group">
      <%= f.label :pinned, 'Pin to Homepage?' %>
    </div>
    <div class="col-sm-7 form-group">
      <%= f.check_box :pinned, class: "big-checkbox form-control" %>
    </div>

    <div class="col-sm-5 form-group">
      <%=f.label :picture_id %>
    </div>

    <div class="col-sm-7 form-group">
      <%= f.select :picture_id, options_for_select(Picture.all.map{ |s| [s.alt_text, s.id]}), {include_blank: "New Picture (or select existing)"}, {class: "dropdown-options form-control", id: "picture-dropdown" } %>
    </div>
    
    <div class="col-sm-10 offset-sm-1 form-group">     
      <div class="#pictures collapse highlight-background" id="collapse-form">
        <%= f.fields_for :pictures do |picture| %>
          <%= render 'picture_fields', f: picture %>
        <% end %>
      </div>
    </div>
    

    <div class="col-sm-5 form-group">
      <%= f.label :picture_url, 'URL for picture' %> (Optional)
    </div>
    <div class="col-sm-7 form-group">
      <%= f.url_field :picture_url, class: "form-control" %>
    </div>
    <div class="col-6 text-center mt-4 form-group">
      <%= f.submit(@post.new_record? ? 'Create new Post' : 'Edit Post', class: "btn btn-default") %>
    </div>
    <div class="col-6 text-center mt-4 form-group">
      <button class="btn btn-default"><%= link_to "Cancel", :back, class: "form-button" %></button>
    </div>
  </div>
<% end %>
<hr/>


<script type="text/javascript">
$(document).ready(function(){
  $('.collapse').collapse();
});

$('#picture-dropdown').change(function(){
  opt = $(this).val();
  if (opt != ""){
    $('#collapse-form').collapse('hide');
  }
  else {
    $('#collapse-form').collapse('show');
  }
});



</script>
<%= render 'shared/errors', obj: @show %> 

<%= form_for @show do |f| %>
  <div class="row main-text">
    <div class="col-sm-5">
      <%= f.label :date %>
    </div>
    <div class="col-sm-7 form-group">
      <%= f.date_field :date, class: "form-control" %>
    </div>
    <div class="col-sm-5 form-group">
      <%= f.label :url, 'Event Link' %>
    </div>
    <div class="col-sm-7 form-group">
      <%= f.url_field :url, class: "form-control" %>
    </div>  
    
    <div class="col-sm-5 form-group">
      <%= f.label :venue_id, 'Venue' %>
    </div> 

    <div class="col-sm-7 form-group">
      <%= f.select :venue_id, options_for_select(Venue.all.map{ |s| [display_venue(s), s.id]}, @show.venue_id), {include_blank: "New Venue (or select existing)"}, {class: "dropdown-options form-control", id: "venue-dropdown" } %>
    </div>
    
    <div class="col-sm-10 offset-sm-1 form-group">     
      <div class="#venues collapse highlight-background" id="collapse-venue-form">
        <%= f.fields_for :venue do |venue| %>
          <%= render 'venue_fields', f: venue %>
        <% end %>
      </div>
    </div>
    
    <div class="col-sm-5 form-group">
      <%=f.label :picture_id %>
    </div>

    <div class="col-sm-7 form-group">
      <%= f.select :picture_id, options_for_select(Picture.all.map{ |s| [s.alt_text, s.id]}, @show.picture_id), {include_blank: "New Picture (or select existing)"}, {class: "dropdown-options form-control", id: "picture-dropdown" } %>
    </div>
    
    <div class="col-sm-10 offset-sm-1 form-group">     
      <div class="#pictures collapse highlight-background" id="collapse-picture-form">
        <%= f.fields_for :picture do |picture| %>
          <%= render 'picture_fields', f: picture %>
        <% end %>
      </div>
    </div>
    
    <div class="col-6 text-center mt-4 form-group">
      <%= f.submit(@show.new_record? ? 'Create new Show' : 'Edit Show', class: "btn btn-default") %>
    </div>
    <div class="col-6 text-center mt-4 form-group">
      <button class="btn btn-default"><%= link_to "Cancel", :back, class: "form-button" %></button>
    </div>

  </div>
  
<% end %>

<hr/>


<script type="text/javascript">
//$(document).ready(function(){
  //$('.collapse').collapse();
//});

$('#venue-dropdown').on("change rightnow", function(){
  opt = $(this).val();
  venue_form = $('#collapse-venue-form');

  if (opt != ""){
    venue_form.collapse('hide');
  }
  else {
    venue_form.collapse('show');
    inputs = venue_form.find('input');
    for (var i = 0; i<inputs.length; i++) {
      if (inputs[i].type == 'text') {
        inputs[i].value = '';
      }
    }
  }
}).triggerHandler("rightnow");
$('#picture-dropdown').on("change rightnow", function(){
  opt = $(this).val();
  picture_form = $('#collapse-picture-form');
  if (opt != ""){
    picture_form.collapse('hide');
  }
  else {
    picture_form.collapse('show');
    inputs = picture_form.find('input');    
    for (var i = 0; i<inputs.length; i++) {
      if (inputs[i].type == 'text') {
        inputs[i].value = '';
      }
    }
  }
}).triggerHandler("rightnow");


</script>